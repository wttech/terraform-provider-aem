---
page_title: "AEM Provider - Resource 'aem_instance'"
subcategory: ""
---

[![AEM Compose Logo](https://github.com/wttech/aemc/raw/main/docs/logo-with-text.png)](https://github.com/wttech/aemc)
[![WTT Logo](https://github.com/wttech/aemc/raw/main/docs/wtt-logo.png)](https://www.wundermanthompson.com/service/technology)

# AEM Provider - Resource 'aem_instance'

The instance resource allows you to create and manage AEM instances.

With this resource, you can set up one or many AEM instances on a single machine. 

If you need to set up multiple AEM instances on multiple machines, you can use this resource multiple times. However, remember to use different client settings and adapt the compose configuration accordingly. This is because the default configuration assumes that both AEM author and publish are set up on the same machine.

## Example usages

Consider reviewing the following examples to find the one that best suits your needs:

1. [AWS EC2 instance with public IP](https://github.com/wttech/terraform-provider-aem/tree/main/examples/aws_ssh)
2. [AWS EC2 instance with private IP](https://github.com/wttech/terraform-provider-aem/tree/main/examples/aws_ssm)
3. [Bare metal machine](https://github.com/wttech/terraform-provider-aem/tree/main/examples/bare_metal_ssh)



<!-- schema generated by tfplugindocs -->
## Schema

### Optional

- `client` (Block, Optional) Connection settings used to access the machine on which the AEM instance will be running. (see [below for nested schema](#nestedblock--client))
- `compose` (Block, Optional) AEM Compose CLI configuration. See [documentation](https://github.com/wttech/aemc#configuration). (see [below for nested schema](#nestedblock--compose))
- `files` (Map of String) Files or directories to be copied into the machine.
- `system` (Block, Optional) Operating system configuration for the machine on which AEM instance will be running. (see [below for nested schema](#nestedblock--system))

### Read-Only

- `instances` (Attributes List) Current state of the configured AEM instances. (see [below for nested schema](#nestedatt--instances))

<a id="nestedblock--client"></a>
### Nested Schema for `client`

Required:

- `settings` (Map of String) Settings for the connection type
- `type` (String) Type of connection to use to connect to the machine on which AEM instance will be running.

Optional:

- `action_timeout` (String) Used when trying to connect to the AEM instance machine (often right after creating it). Need to be enough long because various types of connections (like AWS SSM or SSH) may need some time to boot up the agent.
- `credentials` (Map of String, Sensitive) Credentials for the connection type
- `state_timeout` (String) Used when reading the AEM instance state when determining the plan.


<a id="nestedblock--compose"></a>
### Nested Schema for `compose`

Optional:

- `config` (String) Contents of the AEM Compose YML configuration file.
- `configure` (Attributes) Script(s) for configuring a launched instance. Must be idempotent as it is executed always when changed. Typically used for installing AEM service packs, setting up replication agents, etc. (see [below for nested schema](#nestedatt--compose--configure))
- `create` (Attributes) Script(s) for creating an instance or restoring it from a backup. Typically customized to provide AEM library files (quickstart.jar, license.properties, service packs) from alternative sources (e.g., AWS S3, Azure Blob Storage). Instance recreation is forced if changed. (see [below for nested schema](#nestedatt--compose--create))
- `delete` (Attributes) Script(s) for deleting a stopped instance. (see [below for nested schema](#nestedatt--compose--delete))
- `download` (Boolean) Toggle automatic AEM Compose CLI wrapper download. If set to false, assume the wrapper is present in the data directory.
- `version` (String) Version of AEM Compose tool to use on remote machine.

<a id="nestedatt--compose--configure"></a>
### Nested Schema for `compose.configure`

Optional:

- `inline` (List of String) Inline shell commands to be executed
- `script` (String) Multiline shell script to be executed


<a id="nestedatt--compose--create"></a>
### Nested Schema for `compose.create`

Optional:

- `inline` (List of String) Inline shell commands to be executed
- `script` (String) Multiline shell script to be executed


<a id="nestedatt--compose--delete"></a>
### Nested Schema for `compose.delete`

Optional:

- `inline` (List of String) Inline shell commands to be executed
- `script` (String) Multiline shell script to be executed



<a id="nestedblock--system"></a>
### Nested Schema for `system`

Optional:

- `bootstrap` (Attributes) Script executed once upon instance connection, often for mounting on VM data volumes from attached disks (e.g., AWS EBS, Azure Disk Storage). This script runs only once, even during instance recreation, as changes are typically persistent and system-wide. If re-execution is needed, it is recommended to set up a new machine. (see [below for nested schema](#nestedatt--system--bootstrap))
- `data_dir` (String) Remote root path in which AEM Compose files and unpacked AEM instances will be stored.
- `env` (Map of String) Environment variables for AEM instances.
- `service_config` (String) Contents of the AEM system service definition file (systemd).
- `user` (String) System user under which AEM instance will be running. By default, the same as the user used to connect to the machine.
- `work_dir` (String) Remote root path where provider-related files will be stored.

<a id="nestedatt--system--bootstrap"></a>
### Nested Schema for `system.bootstrap`

Optional:

- `inline` (List of String) Inline shell commands to be executed
- `script` (String) Multiline shell script to be executed



<a id="nestedatt--instances"></a>
### Nested Schema for `instances`

Read-Only:

- `aem_version` (String) Version of the AEM instance. Reflects service pack installations.
- `attributes` (List of String) A brief description of the state details for a specific AEM instance. Possible states include 'created', 'uncreated', 'running', 'unreachable', 'up-to-date', and 'out-of-date'.
- `dir` (String) Remote path in which AEM instance is stored.
- `id` (String) Unique identifier of AEM instance defined in the configuration.
- `run_modes` (List of String) A list of run modes for a specific AEM instance.
- `url` (String) The machine-internal HTTP URL address used for communication with the AEM instance.
